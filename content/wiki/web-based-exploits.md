---
title: "Web-based exploits"
date: 2024-08-21
draft: false
math: false
---

Web-based exploits are malicious code or behavior that's used to take
advantage of coding flaws in a web application.
[Threat actors](/threat-actors) target web-based exploits
to obtain sensitive
personal information. Attacks occur because web applications interact
with multiple users across multiple networks. Malicious hackers commonly
exploit this high level of interaction using injection attacks.

## Injection attack

An injection attack is malicious code inserted ("injected") into a
vulnerable application. The infected application often appears to work
normally. That's because the injected code runs in the background,
unknown to the user. Applications are vulnerable to injection attacks
because they are programmed to receive data inputs. This could be
something the user types, clicks, or something one program is sharing
with another. When coded correctly, applications should be able to
interpret and handle user inputs.

Web apps interact with multiple users across many platforms. They also
have a lot of interactive objects like images and buttons. This makes it
challenging for developers to think of all the ways they should sanitize
their input.

A common and dangerous type of injection
attack that's a threat to web apps is cross-site scripting.

## Cross-site scripting

Cross site scripting, or XSS, is an injection attack that inserts code
into a vulnerable website or web application.
These attacks are often delivered
by exploiting the two languages used by most websites, HTML and JavaScript.
Both can give cybercriminals access
to everything that loads on the infected web page.
This can include session cookies,
geolocation, and even webcams and microphones.

### 3 main types of XSS

1. A **reflected XSS attack** is an instance where a malicious script is
   sent to the server and activated during the server's response. A
   common example of this is the search bar of a website. In a reflected
   XSS attack, criminals send their target a web link that appears to go
   to a trusted site. When they click the link, it sends a HTTP request
   to the vulnerable site server. The attacker script is then returned
   or reflected back to the innocent user's browser. Here, the browser
   loads the malicious script because it trusts the server's response.
   With the script loaded, information like session cookies are sent
   back to the attacker.
2. In a **stored XSS attack**, the malicious script isn't hidden in a
   link that needs to be sent to the server. Instead a stored XSS attack
   is an instance when malicious script is injected directly on the
   server. Here, attackers target elements of a site that are served to
   the user. This could be things like images and buttons that load when
   the site is visited. Infected elements activate the malicious code
   when a user simply visits the site. Stored XSS attacks can be
   damaging because the user has no way of knowing the site is infected
   beforehand.
3. **DOM (Document Object Model)-based XSS attack** is an instance when
   malicious script exists in the web page a browser loads. Unlike
   reflected XSS, these attacks don't need to be sent to the server to
   activate. In a DOM-based attack, a malicious script can be seen in
   the URL. Criminals change the parameter that's expecting an input.
   For example, they could hide malicious JavaScript in the HTML tags.
   The browser would process the HTML and execute the JavaScript.

## SQL injection

A SQL injection is an attack that executes unexpected queries on a
database. Like XSS, SQL injection occurs due to a lack of sanitized
input. The injections take place in the area of the website that are
designed to accept user input. A common example is the login form to
access a site. One of these forms might trigger a backend [SQL](/sql)
statement like this when a user enters their credentials. Web forms are
designed to copy user input into the statement exactly as they're
written.

SQL injections are regularly listed in the [OWASPÂ®](/owasp) Top 10
because developers tend to focus on making their applications work
correctly rather than protecting their products from injection.

The statement then sends a request to the server, which runs the query.
Websites that are vulnerable to SQL injection insert the user's input
exactly as it's entered before running the code.

This is a *serious* design flaw. It happens because web developers
expect people to use these inputs correctly. They don't anticipate
attackers exploiting them. For example, an attacker might insert
additional SQL code. This could cause the server to run a harmful query
of code that it wasn't expecting. Malicious hackers can target these
attack vectors to obtain sensitive information, modify tables and even
gain administrative rights to the database.

### SQL injection categories

1. **In-band (or classic) SQL injection** is one that uses the same
   communication channel to launch the attack and gather the results.
   For example, this might occur in the search box of a retailer's
   website that lets customers find products to buy. If the search box
   is vulnerable to injection, an attacker could enter a malicious query
   that would be executed in the database, causing it to return
   sensitive information like user passwords. The data that's returned
   is displayed back in the search box where the attack was initiated.
2. **Out-of-band SQL injection** one that uses a different communication
   channel to launch the attack and gather the results. For example, an
   attacker could use a malicious query to create a connection between a
   vulnerable website and a database they control. This separate channel
   would allow them to bypass any [security controls](/security-controls) that are in place on the website's
   server, allowing them to steal sensitive data
3. **Inferential SQL injection** occurs when an attacker is unable to
   directly see the results of their attack. Instead, they can interpret
   the results by analyzing the behavior of the system. For example, an
   attacker might perform a SQL injection attack on the login form of a
   website that causes the system to respond with an error message.
   Although sensitive data is not returned, the attacker can figure out
   the database's structure based on the error. They can then use this
   information to craft attacks that will give them access to sensitive
   data or to take control of the system.

### Injection prevention

The best way to defend against SQL injection is to *escape user
inputs*---preventing someone from inserting any code that a program isn't
expecting. Some ways to do this:

A **prepared statement** is a coding technique that executes SQL
statements before passing them on to the database. This means the code
can be validated before performing the query.

**Input sanitization** is coding technique that removes user input which
could be interpreted as code.

**Input validation** is coding technique that ensures user input meets a
system's expectations.
