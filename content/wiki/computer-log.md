---
title: "All about computer logs"
date: 2024-09-04
draft: false
math: false
---

{{< toc >}}

## Intro

A **log** is a record of events that occur within an organization's
systems. Logs contain log entries and each entry details information
corresponding to a single event that happened on a device or system.
Originally, logs served the sole purpose of troubleshooting common
technology issues. For example, error logs provide information about why
an unexpected error occurred and help to identify the root cause of the
error so that it can be fixed.

[Security teams](/security) access logs from logging receivers like
[SIEM](/SIEM) tools which consolidate logs analyze the collected data
and identify events of interest.

## Types of logs

A **firewall log** is a record of attempted or established connections
for incoming traffic from the [internet](/internet). It also includes
outbound requests to the internet from within the [network](/network).

A **network log** is a record of all computers and devices that enter
and leave the network. It also records connections between devices and
services on the network.

**Server log** is a record of events related to services such as
websites, emails, or file shares. It includes actions such as login,
password, and username requests.

**System logs** are generated by operating systems like Chrome OS™,
Windows, Linux, or macOS®.

**Application logs** are generated by software applications and contain
information relating to the events occurring within the application such
as a smartphone app.

**Security logs** are generated by various devices or systems such as
antivirus software and [intrusion detection systems](/intrusion-detection-system).
Security logs
contain security-related information such as file deletion.

**Authentication logs** are generated whenever authentication occurs
such as a successful login attempt into a [computer](/computer).

## Commong log file formats

### JavaScript Object Notation (JSON)

JSON is known for being lightweight and easy to read and write. It is
used for transmitting data in web technologies and is also commonly used
in cloud environments. JSON syntax is derived from JavaScript syntax.

### Syslog

Syslog is a standard for logging and transmitting data. It can be used to refer to any of its three different capabilities:

1. Protocol: The syslog protocol is used to transport logs to a
   centralized log server for log management. It uses port 514 for
   plaintext logs and port 6514 for encrypted logs.
2. Service: The syslog service acts as a log forwarding service that
   consolidates logs from multiple sources into a single location. The
   service works by receiving and then forwarding any syslog log entries
   to a remote server.
3. Log format: The syslog log format is one of the most commonly used
   log formats that you will be focusing on. It is the native logging
   format used in  Unix® systems. It consists of three components: a
   header, structured-data, and a message.

**Note**: Syslog headers can be combined with JSON, and XML formats.
Custom log formats also exist.

### eXtensible Markup Language (XML)

XML is a native file format used in Windows systems. XML syntax uses the following:

- Tags: used to store and identify data. Must have start and end tags.
- Elements: include both the data contained inside of a tag and the tags
  itself. All XML entries must contain at least one root element. Root
  elements contain other elements that sit underneath them, known as
  child elements.
- Attributes: are used to provide additional information about elements.
  Attributes are included as the second part of the tag itself and must
  always be quoted using either single or double quotes.

### Comma Separated Value (CSV)

CSV (Comma Separated Value) uses commas to separate data values. In CSV
logs, the position of the data corresponds to its field name, but the
field names themselves might not be included in the log. It’s critical
to understand what fields the source device (like an IPS, firewall,
scanner, etc.) is including in the log.

### Common Event Format (CEF)

Common Event Format (CEF) is a log format that uses key-value pairs to
structure data and identify fields and their corresponding values. The
CEF syntax is defined as containing the following fields: 

`CEF:Version|Device Vendor|Device Product|Device Version|Signature ID|Name|Severity|Extension`

Fields are all separated with a pipe character `|`. However, anything in
the `Extension` part of the CEF log entry must be written in a key-value
format. Syslog is a common method used to transport logs like CEF. When
Syslog is used a timestamp and hostname will be prepended to the CEF
message.

## Log management

The high volume of logs produced by all devices can be overwhelming. To
get the most value from your logs, you need to choose exactly what to
log, how to access it easily, and keep it secure using log management.

### What to log

The most important aspect of log management is choosing what to log.
It's important to consider which log sources are most likely to contain
the most useful information depending on your event of interest. This
might be configuring log sources to reduce the amount of data they
record, such as excluding excessive verbosity. Some information,
including but not limited to phone numbers, email addresses, and names,
form personally identifiable information (PII), which requires special
handling and in some jurisdictions might not be possible to be logged.

### The issue with overlogging

From a security perspective, it can be tempting to log everything. This
is the most common mistake organizations make. Storing excessive amounts
of logs can have many disadvantages with some SIEM tools, like increase
in cost in storage and maintenance. Also, overlogging can increase the
load on systems, which can cause performance issues and affect
usability, making it difficult to search for and identify important
events.

### Log retention

Organizations might operate in industries with regulatory requirements.
For example, some regulations require organizations to retain logs for
set periods of time and organizations can implement log retention
practices in their log management policy.

- Public sector industries, like the Federal Information Security
  Modernization Act (FISMA)
- Healthcare industries, like the Health Insurance Portability and
  Accountability Act of 1996 (HIPAA)
- Financial services industries, such as the Payment Card Industry Data
  Security Standard (PCI DSS), the Gramm-Leach-Bliley Act (GLBA), and
  the Sarbanes-Oxley Act of 2002 (SOX)

### Log protection

The protection of logs is vital in maintaining log integrity. It’s not
unusual for [malicious actors](/threat-actor) to modify logs in attempts
to mislead security teams and to even hide their activity.

Storing logs in a centralized log server is a way to maintain log
integrity. When logs are generated, they get sent to a dedicated server
instead of getting stored on a local machine.
